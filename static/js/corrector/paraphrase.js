var V=Object.defineProperty;var $=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var k=(s,e,t)=>e in s?V(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,T=(s,e)=>{for(var t in e||(e={}))q.call(e,t)&&k(s,t,e[t]);if($)for(var t of $(e))B.call(e,t)&&k(s,t,e[t]);return s};import{r as S,E as J,j as i,P as Z,u as R,h as G}from"./client-MZ3Q-qTy.js";class H{diff(e,t,n={}){let o;typeof n=="function"?(o=n,n={}):"callback"in n&&(o=n.callback);const r=this.castInput(e,n),l=this.castInput(t,n),a=this.removeEmpty(this.tokenize(r,n)),u=this.removeEmpty(this.tokenize(l,n));return this.diffWithOptionsObj(a,u,n,o)}diffWithOptionsObj(e,t,n,o){var r;const l=f=>{if(f=this.postProcess(f,n),o){setTimeout(function(){o(f)},0);return}else return f},a=t.length,u=e.length;let h=1,c=a+u;n.maxEditLength!=null&&(c=Math.min(c,n.maxEditLength));const x=(r=n.timeout)!==null&&r!==void 0?r:1/0,p=Date.now()+x,m=[{oldPos:-1,lastComponent:void 0}];let v=this.extractCommon(m[0],t,e,0,n);if(m[0].oldPos+1>=u&&v+1>=a)return l(this.buildValues(m[0].lastComponent,t,e));let W=-1/0,y=1/0;const A=()=>{for(let f=Math.max(W,-h);f<=Math.min(y,h);f+=2){let g;const P=m[f-1],w=m[f+1];P&&(m[f-1]=void 0);let L=!1;if(w){const I=w.oldPos-f;L=w&&0<=I&&I<a}const O=P&&P.oldPos+1<u;if(!L&&!O){m[f]=void 0;continue}if(!O||L&&P.oldPos<w.oldPos?g=this.addToPath(w,!0,!1,0,n):g=this.addToPath(P,!1,!0,1,n),v=this.extractCommon(g,t,e,f,n),g.oldPos+1>=u&&v+1>=a)return l(this.buildValues(g.lastComponent,t,e))||!0;m[f]=g,g.oldPos+1>=u&&(y=Math.min(y,f-1)),v+1>=a&&(W=Math.max(W,f+1))}h++};if(o)(function f(){setTimeout(function(){if(h>c||Date.now()>p)return o(void 0);A()||f()},0)})();else for(;h<=c&&Date.now()<=p;){const f=A();if(f)return f}}addToPath(e,t,n,o,r){const l=e.lastComponent;return l&&!r.oneChangePerToken&&l.added===t&&l.removed===n?{oldPos:e.oldPos+o,lastComponent:{count:l.count+1,added:t,removed:n,previousComponent:l.previousComponent}}:{oldPos:e.oldPos+o,lastComponent:{count:1,added:t,removed:n,previousComponent:l}}}extractCommon(e,t,n,o,r){const l=t.length,a=n.length;let u=e.oldPos,h=u-o,c=0;for(;h+1<l&&u+1<a&&this.equals(n[u+1],t[h+1],r);)h++,u++,c++,r.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!r.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=u,h}equals(e,t,n){return n.comparator?n.comparator(e,t):e===t||!!n.ignoreCase&&e.toLowerCase()===t.toLowerCase()}removeEmpty(e){const t=[];for(let n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t}castInput(e,t){return e}tokenize(e,t){return Array.from(e)}join(e){return e.join("")}postProcess(e,t){return e}get useLongestToken(){return!1}buildValues(e,t,n){const o=[];let r;for(;e;)o.push(e),r=e.previousComponent,delete e.previousComponent,e=r;o.reverse();const l=o.length;let a=0,u=0,h=0;for(;a<l;a++){const c=o[a];if(c.removed)c.value=this.join(n.slice(h,h+c.count)),h+=c.count;else{if(!c.added&&this.useLongestToken){let x=t.slice(u,u+c.count);x=x.map(function(p,m){const v=n[h+m];return v.length>p.length?v:p}),c.value=this.join(x)}else c.value=this.join(t.slice(u,u+c.count));u+=c.count,c.added||(h+=c.count)}}return o}}function M(s,e){let t;for(t=0;t<s.length&&t<e.length;t++)if(s[t]!=e[t])return s.slice(0,t);return s.slice(0,t)}function z(s,e){let t;if(!s||!e||s[s.length-1]!=e[e.length-1])return"";for(t=0;t<s.length&&t<e.length;t++)if(s[s.length-(t+1)]!=e[e.length-(t+1)])return s.slice(-t);return s.slice(-t)}function D(s,e,t){if(s.slice(0,e.length)!=e)throw Error(`string ${JSON.stringify(s)} doesn't start with prefix ${JSON.stringify(e)}; this is a bug`);return t+s.slice(e.length)}function F(s,e,t){if(!e)return s+t;if(s.slice(-e.length)!=e)throw Error(`string ${JSON.stringify(s)} doesn't end with suffix ${JSON.stringify(e)}; this is a bug`);return s.slice(0,-e.length)+t}function C(s,e){return D(s,e,"")}function E(s,e){return F(s,e,"")}function N(s,e){return e.slice(0,Q(s,e))}function Q(s,e){let t=0;s.length>e.length&&(t=s.length-e.length);let n=e.length;s.length<e.length&&(n=s.length);const o=Array(n);let r=0;o[0]=0;for(let l=1;l<n;l++){for(e[l]==e[r]?o[l]=o[r]:o[l]=r;r>0&&e[l]!=e[r];)r=o[r];e[l]==e[r]&&r++}r=0;for(let l=t;l<s.length;l++){for(;r>0&&s[l]!=e[r];)r=o[r];s[l]==e[r]&&r++}return r}function j(s){let e;for(e=s.length-1;e>=0&&s[e].match(/\s/);e--);return s.substring(e+1)}function d(s){const e=s.match(/^\s*/);return e?e[0]:""}const _="a-zA-Z0-9_\\u{AD}\\u{C0}-\\u{D6}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",U=new RegExp(`[${_}]+|\\s+|[^${_}]`,"ug");class X extends H{equals(e,t,n){return n.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e.trim()===t.trim()}tokenize(e,t={}){let n;if(t.intlSegmenter){const l=t.intlSegmenter;if(l.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');n=[];for(const a of Array.from(l.segment(e))){const u=a.segment;n.length&&/\s/.test(n[n.length-1])&&/\s/.test(u)?n[n.length-1]+=u:n.push(u)}}else n=e.match(U)||[];const o=[];let r=null;return n.forEach(l=>{/\s/.test(l)?r==null?o.push(l):o.push(o.pop()+l):r!=null&&/\s/.test(r)?o[o.length-1]==r?o.push(o.pop()+l):o.push(r+l):o.push(l),r=l}),o}join(e){return e.map((t,n)=>n==0?t:t.replace(/^\s+/,"")).join("")}postProcess(e,t){if(!e||t.oneChangePerToken)return e;let n=null,o=null,r=null;return e.forEach(l=>{l.added?o=l:l.removed?r=l:((o||r)&&b(n,r,o,l),n=l,o=null,r=null)}),(o||r)&&b(n,r,o,null),e}}const Y=new X;function K(s,e,t){return Y.diff(s,e,t)}function b(s,e,t,n){if(e&&t){const o=d(e.value),r=j(e.value),l=d(t.value),a=j(t.value);if(s){const u=M(o,l);s.value=F(s.value,l,u),e.value=C(e.value,u),t.value=C(t.value,u)}if(n){const u=z(r,a);n.value=D(n.value,a,u),e.value=E(e.value,u),t.value=E(t.value,u)}}else if(t){if(s){const o=d(t.value);t.value=t.value.substring(o.length)}if(n){const o=d(n.value);n.value=n.value.substring(o.length)}}else if(s&&n){const o=d(n.value),r=d(e.value),l=j(e.value),a=M(o,r);e.value=C(e.value,a);const u=z(C(o,a),l);e.value=E(e.value,u),n.value=D(n.value,o,u),s.value=F(s.value,o,o.slice(0,o.length-u.length))}else if(n){const o=d(n.value),r=j(e.value),l=N(r,o);e.value=E(e.value,l)}else if(s){const o=j(s.value),r=d(e.value),l=N(o,r);e.value=C(e.value,l)}}function ee(){const[s,e]=S.useState(null);return S.useEffect(()=>{(window._correctorEvents||(window._correctorEvents=new J)).on("set-selected-match",n=>{e(n)})},[]),s?i.jsx(i.Fragment,{children:i.jsx("style",{children:`
            [data-match-id="${s}"] {
                border-bottom: purple solid 3px;
                  }
        `})}):i.jsx(i.Fragment,{})}const te=()=>i.jsxs(Z,{children:[i.jsx("div",{className:"paraphrase-area",style:{maxWidth:"768px",margin:"auto"},children:i.jsx("div",{children:i.jsx(ne,{})})}),i.jsx(ee,{})]});function ne(){const{state:s,setParaphraseText:e}=R();return S.useEffect(()=>{(window._correctorEvents||(window._correctorEvents=new J)).on("set-text",n=>{e(n.segment)})},[e]),s?i.jsxs(i.Fragment,{children:[i.jsx("h2",{children:s.text}),i.jsx(se,{alternatives:s.alternatives})]}):i.jsx(i.Fragment,{})}function se({alternatives:s}){if(s)return i.jsxs(i.Fragment,{children:[i.jsx("h3",{children:"Alternatives:"}),i.jsx("ul",{children:s.map((e,t)=>{const n=`alt-${t}`;return i.jsx(re,T({parentKey:n},e),n)})})]})}function oe(s,e,t){return K(e,t).map((o,r)=>{const l=`${s}-${r}`;return o.added?i.jsx("span",{style:{fontWeight:"bold"},children:o.value},l):o.removed?i.jsx(i.Fragment,{}):i.jsx("span",{style:{color:"black"},children:o.value},l)})}function re({text:s,parentKey:e}){const{selectAlternative:t,state:n}=R();if(!n)return i.jsx(i.Fragment,{});const o=oe(e,n.text,s);return i.jsx("li",{children:i.jsx("a",{style:{color:"black"},onClick:r=>{t(s),r.preventDefault()},children:o})})}const le=document.getElementById("paraphrase"),ue=G(le);ue.render(i.jsx(te,{}));
//# sourceMappingURL=paraphrase.js.map
